const fecha=new Date,hora=fecha.toLocaleTimeString(),horaMin=hora.substr(0,5),horas=(fecha.getHours()<10?"0":"")+fecha.getHours(),minutos=(fecha.getMinutes()<10?"0":"")+fecha.getMinutes(),urlPrueba="https://www.alkosto.com/nuestra-compania/tiendas/c/tiendas",urlSite=window.location.href.split("/")[2],formatoHora=`${horas}:${minutos}`,fechaComoCadena=fecha,dias=["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],buscador=document.getElementById("search"),listaCoincidencias=document.getElementById("listaCoincidencias"),content=document.getElementById("content"),resultSearch=document.querySelector("#result-search"),svConfianza=document.querySelector("#sv-confianza"),carrusel=document.querySelector("#cont-carrusel"),titleServ=document.querySelector("#title-serv"),btn_tiendas=document.querySelector("#all-tiendas"),contInput=document.querySelector("#cont-input");var urlKT="https://feeds.datafeedwatch.com/95958/fb2f5eb90322be8f5cb1aea469a4551436034440.json",urlAK="https://feeds.datafeedwatch.com/95958/3a4f7dba63e51e01ff8ad165f123a825cf30f99b.json",urlALKP="https://feeds.datafeedwatch.com/95958/c75c33c5369da362ae3e6fafb56ecd0b0ef78319.json",textoIngresado="";let opSelect,urlAPI;switch(urlSite){case"www.alkosto.com":urlAPI=urlAK,site="Tiendas Alkosto";break;case"www.ktronix.com":urlAPI=urlKT,site="Tiendas Ktronix";break;case"www.alkomprar.com":urlAPI=urlALKP,site="Tiendas Alkomprar"}let globalData={};const numeroDia=new Date(fechaComoCadena).getDay(),nombreDia=dias[numeroDia];function limpiarTexto(a){return a.replace().replace(/[áàäâå]/,"a").replace(/[éèëê]/,"e").replace(/[íìïî]/,"i").replace(/[óòöô]/,"o").replace(/[úúüû]/,"u").replace(/[ñ]/,"n").replace(/[\s()/*´'{}]+/gi,"-").replace(/[\u0300-\u036f]/g,"").toLowerCase()}contInput.addEventListener("click",(()=>{buscador.focus()}));for(let a=numeroDia;a<dias.length;a++){for(let a=numeroDia;a>dias.length;a--){array[a]}}function allTiendas(){fetch(`${urlAPI}`).then((a=>a.json())).then((a=>{globalData["info-all"]=a.products;let e=globalData["info-all"];infoTiendas(e)}));buscador.setAttribute("placeholder","Ingresa el nombre de tu municipio"),buscador.value="",contInput.innerHTML='<i class="alk-icon-search-mobile icon-search"></i>'}function allStores(){btn_tiendas.classList.add("hidden"),buscador.setAttribute("placeholder","Ingresa tu municipio o departamento"),infoTiendas(globalData["info-all"])}const infoTiendas=a=>{if(listaCoincidencias.innerHTML="",content.innerHTML="",resultSearch.innerHTML="",a.length>=1){const e=a.filter((a=>a.tienda==site)).sort(((a,e)=>a.nombre_tienda.localeCompare(e.nombre_tienda)));if(e.length>=1){let a=e.map(((a,e)=>{let r=e,o=a.dir_tienda,s=a.url_llegar,i=a.url_tienda,n="";switch(horLunes="","Cerrado"==a.ap_lun&&"Cerrado"==a.cie_lun?horLunes="Cerrado":horLunes=`${a.ap_lun.substr(0,5)} a. m. - ${a.cie_lun.substr(0,2)-12}${a.cie_lun.substr(2,3)} p. m.`,horMartes="","Cerrado"==a.ap_mar&&"Cerrado"==a.cie_mar?horMartes="Cerrado":horMartes=`${a.ap_mar.substr(0,5)} a. m. - ${a.cie_mar.substr(0,2)-12}${a.cie_mar.substr(2,3)} p. m.`,horMie="","Cerrado"==a.ap_mie&&"Cerrado"==a.cie_mie?horMie="Cerrado":horMie=`${a.ap_mie.substr(0,5)} a. m. - ${a.cie_mie.substr(0,2)-12}${a.cie_mie.substr(2,3)} p. m.`,horJueves="","Cerrado"==a.ap_jue&&"Cerrado"==a.cie_jue?horJueves="Cerrado":horJueves=`${a.ap_jue.substr(0,5)} a. m. - ${a.cie_jue.substr(0,2)-12}${a.cie_jue.substr(2,3)} p. m.`,horViernes="","Cerrado"==a.ap_vie&&"Cerrado"==a.cie_vie?horViernes="Cerrado":horViernes=`${a.ap_vie.substr(0,5)} a. m. - ${a.cie_vie.substr(0,2)-12}${a.cie_vie.substr(2,3)} p. m.`,horSab="","Cerrado"==a.ap_sab&&"Cerrado"==a.cie_sab?horSab="Cerrado":horSab=`${a.ap_sab.substr(0,5)} a. m. - ${a.cie_sab.substr(0,2)-12}${a.cie_sab.substr(2,3)} p. m.`,horDom="","Cerrado"==a.ap_dom&&"Cerrado"==a.cie_dom?horDom="Cerrado":horDom=`${a.ap_dom.substr(0,5)} a. m. - ${a.cie_dom.substr(0,2)-12}${a.cie_dom.substr(2,3)} p. m.`,console.log(horDom),console.log(a.ap_dom),numeroDia){case 1:"Cerrado"!=a.ap_lun||"Cerrado"!=a.cie_lun?(hora_apertura=a.ap_lun.substr(0,5),aj_hora_cierre=a.cie_lun.substr(0,2)-12,aj_hora_cierre2=a.cie_lun.substr(2,3),hora_cierre=`${aj_hora_cierre}${aj_hora_cierre2}`,horTienda=hora_apertura<=formatoHora&&a.cie_lun>=formatoHora?`<h2 class="card-subtitle">\n                    ${a.nombre_tienda} </h2> <span class="badge bg-primary">Abierto</span>`:`<h2 class="card-subtitle">\n                    ${a.nombre_tienda} </h2><span class="badge bg-danger">Cerrado</span>`,n=`<p class="horario abierto"><i class="alk-icon-clock"></i> hoy de ${hora_apertura} a. m. - ${hora_cierre} p. m.</p>`):(horTienda=`<h2 class="card-subtitle">\n                            ${a.nombre_tienda} </h2><span class="badge bg-danger">Cerrado</span>`,n='<p class="horario abierto"><i class="alk-icon-clock"></i>Cerrado</p>');break;case 2:"Cerrado"!=a.ap_mar||"Cerrado"!=a.ap_mar?(hora_apertura=a.ap_mar.substr(0,5),aj_hora_cierre=a.cie_mar.substr(0,2)-12,aj_hora_cierre2=a.cie_mar.substr(2,3),hora_cierre=`${aj_hora_cierre}${aj_hora_cierre2}`,horTienda=hora_apertura<=formatoHora&&hora_cierre>=formatoHora?`<h2 class="card-subtitle">\n                    ${a.nombre_tienda} </h2> <span class="badge bg-primary">Abierto</span>`:`<h2 class="card-subtitle">\n                    ${a.nombre_tienda} </h2><span class="badge bg-danger">Cerrado</span>`,n=`<p class="horario abierto"><i class="alk-icon-clock"></i> hoy de ${hora_apertura} a. m. - ${hora_cierre} p. m.</p>`):(horTienda=`<h2 class="card-subtitle">\n                        ${a.nombre_tienda} </h2><span class="badge bg-danger">Cerrado</span>`,n='<p class="horario abierto"><i class="alk-icon-clock"></i>Cerrado</p>');break;case 3:"Cerrado"!=a.ap_mie||"Cerrado"!=a.cie_mie?(hora_apertura=a.ap_mie.substr(0,5),aj_hora_cierre=a.cie_mie.substr(0,2)-12,aj_hora_cierre2=a.cie_mie.substr(2,3),hora_cierre=`${aj_hora_cierre}${aj_hora_cierre2}`,txtBadge="",horTienda=hora_apertura<=formatoHora&&hora_cierre>=formatoHora?`<h2 class="card-subtitle">\n                    ${a.nombre_tienda} </h2> <span class="badge bg-primary">Abierto</span>`:`<h2 class="card-subtitle">\n                    ${a.nombre_tienda}</h2><span class="badge bg-danger">Cerrado</span>`,n=`<p class="horario abierto"><i class="alk-icon-clock"></i> hoy de ${hora_apertura} a. m. - ${hora_cierre} p. m.</p>`):(horTienda=`<h2 class="card-subtitle">\n                        ${a.nombre_tienda} </h2><span class="badge bg-danger">Cerrado</span>`,n='<p class="horario abierto"><i class="alk-icon-clock"></i>Cerrado</p>');break;case 4:"Cerrado"!=a.ap_jue||"Cerrado"!=a.cie_jue?(hora_apertura=a.ap_jue.substr(0,5),aj_hora_cierre=a.cie_jue.substr(0,2)-12,aj_hora_cierre2=a.cie_jue.substr(2,3),hora_cierre=`${aj_hora_cierre}${aj_hora_cierre2}`,txtBadge="",horTienda=hora_apertura<=formatoHora&&hora_cierre>=formatoHora?`<h2 class="card-subtitle">\n                    ${a.nombre_tienda} </h2> <span class="badge bg-primary">Abierto</span>`:`<h2 class="card-subtitle">\n                    ${a.nombre_tienda}</h2><span class="badge bg-danger">Cerrado</span>`,n=`<p class="horario abierto"><i class="alk-icon-clock"></i> hoy de ${hora_apertura} a. m. - ${hora_cierre} p. m.</p>`):(horTienda=`<h2 class="card-subtitle">\n                        ${a.nombre_tienda} </h2><span class="badge bg-danger">Cerrado</span>`,n='<p class="horario abierto"><i class="alk-icon-clock"></i>Cerrado</p>');break;case 5:if("Cerrado"!=a.ap_vie||"Cerrado"!=a.cie_vie){hora_apertura=a.ap_vie.substr(0,5),aj_hora_cierre=a.cie_vie.substr(0,2)-12,aj_hora_cierre2=a.cie_vie.substr(2,3),hora_cierre=`${aj_hora_cierre}${aj_hora_cierre2}`,txtBadge="",horTienda=hora_apertura<=formatoHora&&hora_cierre>=formatoHora?`<h2 class="card-subtitle">\n                    ${a.nombre_tienda} </h2> <span class="badge bg-primary">Abierto</span>`:`<h2 class="card-subtitle">\n                    ${a.nombre_tienda}</h2><span class="badge bg-danger">Cerrado</span>`,n=`<p class="horario abierto"><i class="alk-icon-clock"></i> hoy de ${hora_apertura} a. m. - ${hora_cierre} p. m.</p>`,console.log("Viernes");break}horTienda=`<h2 class="card-subtitle">\n                        ${a.nombre_tienda} </h2><span class="badge bg-danger">Cerrado</span>`,n='<p class="horario abierto"><i class="alk-icon-clock"></i>Cerrado</p>';case 6:"Cerrado"!=a.ap_sab||"Cerrado"!=a.cie_sab?(hora_apertura=a.ap_sab.substr(0,5),aj_hora_cierre=a.cie_sab.substr(0,2)-12,aj_hora_cierre2=a.cie_sab.substr(2,3),hora_cierre=`${aj_hora_cierre}${aj_hora_cierre2}`,horTienda=hora_apertura<=formatoHora&&hora_cierre>=formatoHora?`<h2 class="card-subtitle">\n                    ${a.nombre_tienda} </h2> <span class="badge bg-primary">Abierto</span>`:`<h2 class="card-subtitle">\n                    ${a.nombre_tienda}</h2><span class="badge bg-danger">Cerrado</span>`,n=`<p class="horario abierto"><i class="alk-icon-clock"></i> hoy de ${hora_apertura} a. m. - ${hora_cierre} p. m.</p>`,console.log("Sabado")):(horTienda=`<h2 class="card-subtitle">\n                            ${a.nombre_tienda} </h2><span class="badge bg-danger">Cerrado</span>`,n='<p class="horario abierto"><i class="alk-icon-clock"></i>Cerrado</p>');break;case 0:"Cerrado"!=a.ap_dom||"Cerrado"!=a.cie_dom?(hora_apertura=a.ap_dom.substr(0,5),aj_hora_cierre=a.cie_dom.substr(0,2)-12,aj_hora_cierre2=a.cie_dom.substr(2,3),hora_cierre=`${aj_hora_cierre}${aj_hora_cierre2}`,horTienda=hora_apertura<=formatoHora&&hora_cierre>=formatoHora?`<h2 class="card-subtitle">\n                    ${a.nombre_tienda} </h2> <span class="badge bg-primary">Abierto</span>`:`<h2 class="card-subtitle">\n                    ${a.nombre_tienda} </h2><span class="badge bg-danger">Cerrado</span>`,n=`<p class="horario abierto"><i class="alk-icon-clock"></i> hoy de ${hora_apertura} a. m. - ${hora_cierre} p. m.</p>`,console.log("Domingo")):(horTienda=`<h2 class="card-subtitle">\n                            ${a.nombre_tienda} </h2><span class="badge bg-danger">Cerrado</span>`,n='<p class="horario abierto"><i class="alk-icon-clock"></i>Cerrado</p>')}return`\n                                <div class="col-sm-6 col-md-4">\n                                <div class="card">\n                                <div class="card-header">\n                                ${horTienda}\n                                </div>\n                                <div class="card-body">\n                                <div class="cont-info-card">\n                                <p class="horario-tienda">${o}</p>\n                                <div data-toggle="collapse" data-target="#horariosAcordion${r}" class="accordion-button collapsed">\n                                ${n}\n                                </div>\n                                <div class="collapse" id="horariosAcordion${r}">\n                                <ul class="list-horario">\n                                <li>Lunes: ${horLunes} </li>\n                                <li>Martes: ${horMartes}</li>\n                                <li>Miércoles: ${horMie}</li>\n                                <li>Jueves: ${horJueves}</li>\n                                <li>Viernes: ${horViernes}</li>\n                                <li>Sábado: ${horSab}</li>\n                                <li>Domingo: ${horDom}</li>\n                                </ul>\n                                </div>\n                                </div>\n                                <div class="row d-flex">\n                                <a class="btn-detail" href="${i}" title="ir a tienda ${a.nombre_tienda}">\n                                <div class="btn-card">\n                                Ver detalle\n                                </div>\n                                </a>\n                                <a class="btn-detail" href="${s}" title="Como llegar a ${a.nombre_tienda}">\n                                <div class="btn-card bl-d">\n                                Cómo llegar\n                                </div>\n                                </a>\n                                </div>\n                                </div>\n                                </div>\n                                </div>\n                                `})).join("");return document.addEventListener("click",(function(a){a.target.classList.contains("accordion-button")||document.querySelectorAll(".collapse.show").forEach((function(a){new bootstrap.Collapse(a,{toggle:!1}).hide()}))})),void(content.innerHTML=content.innerHTML+a)}a.map((a=>{content.innerHTML=`\n                <div class="col-md-12">\n                <p>Actualmente no contamos con una tienda física en tu destino, pero recuerda que tienes <b>envío gratis a ${a.ciudad_tienda}</b> por todas tus compras en línea.</p>\n                </div>\n                <div class="col-sm-6 col-md-4">\n                <div class="cont-card">\n                    <div class="card">\n                        <div class="card-header header-envio">\n                            <h2 class="card-subtitle">${a.ciudad_tienda}</h2>\n                            <span class="badge bg-primary">Envío gratis</span>\n                        </div>\n                        <div class="card-body">\n                        <p class="txt-blue">Tiempo estimado de entrega: ${a.dias_entrega} días hábiles.</p>\n                        <div class="cont-horario">\n                            <div class="cnt-icon">\n                                <i class="alk-icon-clock"></i>\n                            </div>\n                            <div class="txt-horario">\n                                <p class="m-0">Lunes a Domingo</p>\n                                <p>${a.hor_entrega}</p>\n                            </div>\n                        </div>\n                        </div>\n                        <a href="/entregas-devoluciones/envio-gratis/c/envio-gratis" class="btn-envio">\n                        <div class="cnt-btn-envio">\n                            Conoce más sobre envío gratis\n                            </div>\n                            </a>\n                    </div>\n                </div>\n                </div>\n                `})),document.querySelector(".card-subtitle").style.width="65%"}},buscarResultados=async a=>{btn_tiendas.classList.add("hidden"),consulta=globalData["info-all"];let e=consulta.filter((e=>{new RegExp(`^${limpiarTexto(a)}`,"gi");return textoIngresado=a,limpiarTexto(e.ciudad_tienda)}));0===a.length?(e=[],contInput.innerHTML='<i class="alk-icon-search-mobile icon-search"></i>'):a.length>2&&printRes(e)},printRes=a=>{listaCoincidencias.innerHTML="",content.innerHTML="",resultSearch.innerHTML="";let e="";if(carrusel.style.display="none",a.length>0){contInput.innerHTML='<i class="alk-icon-close icon-search" title="Limpiar campo"></i>',contInput.addEventListener("click",(()=>{buscador.value="",contInput.innerHTML='<i class="alk-icon-search-mobile icon-search"></i>',listaCoincidencias.innerHTML="",buscador.setAttribute("placeholder","Ingresa tu municipio o departamento"),buscador.focus()}),4e3);let e=new Set;a.map((a=>{let r=a.ciudad_tienda,o=limpiarTexto(buscador.value),s=limpiarTexto(r);s.includes(o)&&!e.has(s)&&(buscador.style.border="",listaCoincidencias.style.display="block",listaCoincidencias.innerHTML+=`<span id="${s}" class="selectOp"><div class="dropdown-item">\n            <div class="panel panel-default">\n            <div class="panel-heading">\n            <p><i class="alk-icon-pin-generico"></i> ${r}</p>\n            </div>\n            </div>\n            </div></span>`,e.add(s))})).join("")}e=listaCoincidencias.querySelectorAll("span");for(let a=0;a<e.length;a++)opSelect=e[a].id,e[a].addEventListener("click",(function(){console.log(e[a].id),buscador.setAttribute("placeholder",e[a].innerText),cardSeleccionada(e[a].id)}));0===e.length&&(listaCoincidencias.style.display="block",listaCoincidencias.innerHTML='<div class="cont-no-results txt-center">\n        \n        <img class="img img-responsive" src="https://www.alkosto.com/medias/no-resultados-envio.png?context=bWFzdGVyfG1ldG9kb3MtZW52aW98MTA4MjB8aW1hZ2UvcG5nfGhjNS9oYWQvMTM1Njg3MDk1MjU1MzQvbm9fcmVzdWx0YWRvc19lbnZpby5wbmd8NDFjYmNlYWQ1YzFmYTRkNmEyZjdkOGY3Yzg5Mzk2Mjc2OWQ2NGI1ZTM0ZjhkMzU0ZmU1ZWEwZDA1ODBhZmNmYQ"/>\n        <div class="txt-no-results txt-center">\n        <h4>¡Aún no llegamos a tu destino!\n        Seguimos trabajando para ello.</h4>\n        </div>\n        </div>',buscador.style.border="1px solid #DD171B",contInput.innerHTML='<i class="alk-icon-close icon-borrar" title="Limpiar campo"></i>',contInput.addEventListener("click",(()=>{contInput.innerHTML='<i class="alk-icon-search-mobile icon-search"></i>',buscador.value="",buscador.style.border="",buscador.setAttribute("placeholder","Ingresa el nombre de tu municipio"),buscador.focus(),allStores()})))},cardSeleccionada=a=>(contInput.innerHTML='<i class="alk-icon-search-mobile icon-search"></i>',listaCoincidencias.style.display="none",filterCiudad=globalData["info-all"].filter((e=>limpiarTexto(e.ciudad_tienda)==a)),btn_tiendas.classList.remove("hidden"),buscador.value="",infoTiendas(filterCiudad),filterCiudad);allTiendas(),btn_tiendas.addEventListener("click",allStores),buscador.addEventListener("input",(()=>buscarResultados(buscador.value)));